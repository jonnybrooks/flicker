"use strict";var Flicker=function(){function e(r){return j.paused?j:("forward"===j.direction?r>=j.animation.frames.length?(j.paused=!0,console.log("animation completed forward")):(s(r),r++):"reverse"===j.direction&&(0>r?(j.paused=!0,console.log("animation completed reverse")):(s(r),r--)),setTimeout(requestAnimationFrame.bind(null,e.bind(null,r)),1e3/24),j)}function s(e){var s=""+j.rootPath+j.animation.frames[e].src,r=document.querySelector('.sprites img[src="'+s+'"]');j.currentSprite=r,j.currentFrame=e;try{x.drawImage(r,-1*j.animation.frames[e].x,-1*j.animation.frames[e].y)}catch(c){throw new Error("Failed to draw image at path '"+s+'\'\r\nThis error usually occurs when the animation tries to draw a sprite which is not within this flicker context; try adding this within your flicker context:\r\n\r\n<img class="sprite" src="'+s+'" alt=" "/>')}}function r(s){var r=s||j.currentFrame;return j.paused=!1,j.direction="forward",e(r),j}function c(s){var r=s||j.currentFrame;return j.paused=!1,j.direction="reverse",e(r),j}function p(){return j.paused=!0,j}function t(e){return j._delay+=e,{play:function(){return setTimeout(r,1e3*j._delay),j},reverse:function(){return setTimeout(c,1e3*j._delay),j},pause:function(){return setTimeout(p,1e3*j._delay),j},wait:function(){return setTimeout(t,1e3*j._delay),j}}}function n(){return p(),s(this.getAttribute("value")),j}var i=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],u=function(){if(i.container)return i.container;throw new Error("You must specify a container for the Flicker context")}(),g=function(){var e=Array.prototype.slice.call(u.querySelectorAll(".sprite"));if(e.length>0)return e;throw new Error("Each Flicker context must contain at least one sprite")}(),y=u.querySelector("canvas"),x=y.getContext("2d"),q=u.querySelector(".controls input"),_={waitOnImages:function(e){var s=[];s.push=function(){Array.prototype.push.apply(this,arguments),this.length>=g.length&&e.call(j)};for(var r=0;r<g.length;r++)g[r].onload=function c(e){g[e].complete?s.push(g[e]):setTimeout(c.bind(null,e),10)}(r)},throttle:function(e,s,r){s||(s=100);var c,p;return function(){var t=r||this,n=+new Date,i=arguments;c&&c+s>n?(clearTimeout(p),p=setTimeout(function(){c=n,e.apply(t,i)},s)):(c=n,e.apply(t,i))}}},j={animation:function(){if(i.animation)return i.animation;throw new Error("Animation can't be undefined")}(),rootPath:i.rootPath||"flicker/",container:u,paused:!1,direction:"forward",currentFrame:0,currentSprite:g[0].src,play:r,reverse:c,pause:p,wait:t,seek:n,utils:_,_delay:0};return q.setAttribute("max",j.animation.frames.length-1),q.addEventListener("input",_.throttle(n)),j};
